<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Spot the Fake! ‚Äî Faktenchecker Stufe 1</title>
<link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans:wght@400;500;600&display=swap" rel="stylesheet">
<style>
  :root{--bg:#fff;--text:#1a1a1a;--accent:#0056b3;--accent-light:#e8f0fe;--ok:#067a32;--warn:#c75100;--muted:#666}
  *{box-sizing:border-box}
  body{margin:0;background:var(--bg);color:var(--text);font-family:"IBM Plex Sans",system-ui,-apple-system,"Segoe UI",Roboto,sans-serif;line-height:1.7}
  main{max-width:960px;margin:3.5rem auto;padding:0 1.5rem}

  /* Header */
  h1{color:var(--accent);margin:0 0 .25rem;font-size:1.9rem}
  .subtitle{color:var(--muted);margin:0 0 2rem}

  /* Home / Level cards */
  #home{display:grid;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));gap:16px}
  .card{border:1px solid #e7ebf3;border-radius:12px;padding:16px;transition:box-shadow .2s;cursor:pointer;background:#fff}
  .card:hover{box-shadow:0 8px 18px rgba(0,0,0,.06)}
  .card h2{margin:.25rem 0 .5rem;font-size:1.1rem;color:var(--text)}
  .tag{display:inline-block;background:#f5f8ff;color:var(--accent);padding:4px 8px;border-radius:999px;font-size:.8rem;margin-bottom:.5rem}
  .teaser{color:#424242;font-size:.95rem}

  /* Game area */
  #game{display:none}
  .topbar{display:flex;align-items:center;gap:12px;margin-bottom:8px}
  .back{background:#f1f3f6;color:var(--text);border:1px solid #e5e7eb;border-radius:8px;padding:.5rem .8rem;cursor:pointer}
  .post{user-select:none;text-align:justify;text-justify:inter-word;hyphens:auto}
  .post p{margin:0 0 1.2rem}
  .token{padding:1px 2px;border-radius:3px;cursor:pointer;transition:background .15s}
  .token:hover{background:var(--accent-light)}
  .token.marked{background:#cde3ff}
  .controls{margin-top:1.5rem;display:flex;gap:.8rem;align-items:center}
  .btn{background:var(--accent);color:#fff;border:0;border-radius:8px;padding:.6rem 1rem;cursor:pointer}
  .btn.secondary{background:#f1f3f6;color:var(--text)}
  .score{margin-left:auto;color:var(--muted)}
  .feedback{margin-top:2rem;border-top:1px solid #e5e5e5;padding-top:1rem}
  .phrase-correct{color:var(--ok)} .phrase-missed{color:var(--warn)}
</style>
</head>
<body>
<main>
  <h1>üïµÔ∏è Spot the Fake!</h1>
  <p class="subtitle">W√§hle ein Szenario, lies den Text und markiere Formulierungen, die auf Desinformation oder manipulative Rhetorik hindeuten.</p>

  <!-- HOME / LEVEL-AUSWAHL -->
  <section id="home"></section>

  <!-- GAME -->
  <section id="game" aria-live="polite">
    <div class="topbar">
      <button id="backBtn" class="back">‚Üê Zur√ºck</button>
      <div id="levelTitle" style="font-weight:600"></div>
    </div>

    <div id="post" class="post"></div>

    <div class="controls">
      <button id="checkBtn" class="btn">Antwort pr√ºfen</button>
      <button id="resetBtn" class="btn secondary">Zur√ºcksetzen</button>
      <span class="score">Punkte: <span id="score">0</span></span>
    </div>

    <div id="feedback" class="feedback"></div>
  </section>
</main>

<script>
/* ============================================================
   Architektur:
   - levels[] enth√§lt je Level: title, teaser, source (mit Absatz-Marker), phraseSpecs
   - Alles (Tokenizing, Phrasen-Mapping, Rendering) basiert auf EINEM String (source)
   - Absatz-Marker PARA erzeugt echte <p> beim Rendern, ohne Indizes zu verschieben
   ============================================================ */
const PARA = "¬ß¬∂¬ß";

/* ---------- LEVEL 1 (dein bestehender Energie-Text) ---------- */
const level1 = {
  id: "energy",
  title: "‚ÄûNetzstabilisierung‚Äú oder doch Rationierung?",
  teaser: "Bericht √ºber angebliche, geplante Stromabschaltungen und ‚ÄöInsider‚Äò ‚Äî klingt investigativ, ist aber voller weicher Behauptungen.",
  source: [
    "Berlin ‚Äì Was viele bef√ºrchtet haben, scheint sich nun zu best√§tigen: Nach Informationen, die unserer Redaktion exklusiv vorliegen, arbeitet die Bundesregierung offenbar schon seit Monaten an einem Programm f√ºr geplante Stromabschaltungen. Offiziell spricht man von ‚ÄûNetzstabilisierung‚Äú ‚Äì doch Insider sagen, es gehe in Wahrheit um eine schrittweise Vorbereitung der Bev√∂lkerung auf Engp√§sse im Winter.",
    "Mehrere Mitarbeiter aus Energieunternehmen und Beh√∂rden berichten √ºbereinstimmend, dass in internen Sitzungen bereits ‚ÄûSimulationen regionaler Strompausen‚Äú durchgef√ºhrt worden seien. Ein Beteiligter, der anonym bleiben m√∂chte, erkl√§rte: ‚ÄûDie Leute sollen sich an den Gedanken gew√∂hnen, dass Strom kein Selbstverst√§ndnis mehr ist.‚Äú",
    "Laut den uns vorliegenden Unterlagen ‚Äì deren Echtheit von keiner offiziellen Stelle bestritten wurde ‚Äì sind zun√§chst Testl√§ufe in Ballungsgebieten geplant. Dabei sollen in kurzen Intervallen bestimmte Stromkreise vom Netz genommen werden, um das Verhalten der Verbraucher zu beobachten. ‚ÄûDas nennt man in den Dokumenten ‚ÄòVerbrauchsanpassung‚Äô, aber es ist nichts anderes als Rationierung,‚Äú so ein Insider.",
    "Bemerkenswert ist, dass gro√üe Medien bisher kaum dar√ºber berichten. Stattdessen werden Kritiker, die diese Vorg√§nge √∂ffentlich machen, als ‚ÄûVerschw√∂rungstheoretiker‚Äú abgetan. Dabei liegen die Hinweise offen auf dem Tisch: Protokolle, interne Mails, Gespr√§che mit Branchenvertretern ‚Äì all das ergibt ein klares Bild.",
    "Mehrere Leserinnen und Leser haben uns zudem berichtet, dass es in den letzten Wochen vermehrt zu kurzzeitigen Stromausf√§llen gekommen sei ‚Äì vor allem nachts. Zufall? Kaum vorstellbar. W√§hrend offizielle Stellen beschwichtigen, mehren sich die Stimmen, die sagen, dass die Wahrheit bald nicht mehr zu verbergen ist. Immer mehr Menschen fordern Aufkl√§rung. Und je l√§nger die Regierung schweigt, desto klarer wird: Da ist etwas dran."
  ].join(` ${PARA} `),
  phraseSpecs: [
    { text:"Was viele bef√ºrchtet haben, scheint sich nun zu best√§tigen", explanation:"Angstmachender Einstieg ohne Beleg ‚Äì suggeriert Dringlichkeit." },
    { text:"die unserer Redaktion exklusiv vorliegen", explanation:"‚ÄöExklusiv‚Äò wirkt glaubw√ºrdig, ist aber nicht √ºberpr√ºfbar." },
    { text:"offenbar schon", explanation:"Klingt sachlich, bedeutet aber nur eine Vermutung." },
    { text:"doch Insider sagen", explanation:"Unklare Quelle ‚Äì beliebtes Stilmittel f√ºr Pseudo-Enth√ºllungen." },
    { text:"Mehrere Mitarbeiter aus Energieunternehmen und Beh√∂rden", explanation:"Vage Gruppenquelle ohne Nachweis ‚Äì klassisches Fake-News-Muster." },
    { text:"deren Echtheit von keiner offiziellen Stelle bestritten wurde", explanation:"Fehlende Dementis werden als Beweis verkauft ‚Äì logischer Trick." },
    { text:"Bemerkenswert ist, dass gro√üe Medien bisher kaum dar√ºber berichten", explanation:"Misstrauens-Narrativ gegen√ºber seri√∂sen Medien." },
    { text:"Und je l√§nger die Regierung schweigt, desto klarer wird: Da ist etwas dran.", explanation:"Beweislast-Umkehr ‚Äì Schweigen wird als Schuld interpretiert." }
  ]
};

/* ---------- LEVEL 2 (neues Szenario) ---------- */
const level2 = {
  id: "chem",
  title: "Geheime Zusatzstoffe im Trinkwasser ‚Äûnachgewiesen‚Äú?",
  teaser: "Pseudowissenschaftlicher Ton, ‚ÄöLaborberichte‚Äò und Schweigekartell-Frame ‚Äî ideal, um Pr√ºfwege zu trainieren.",
  source: [
    "Eine neue Laboranalyse, die unserer Redaktion exklusiv zugespielt wurde, soll belegen, dass in mehreren St√§dten bislang verschwiegene Zusatzstoffe ins Trinkwasser gelangt sind. Aus gut informierten Kreisen hei√üt es, die Verantwortlichen h√§tten die √ñffentlichkeit bewusst im Unklaren gelassen, um Panik zu vermeiden.",
    "Mehrere B√ºrgerinitiativen berichten √ºbereinstimmend von Geschmacksver√§nderungen und Hautreizungen. In Chatgruppen kursieren Fotos von angeblichen Pr√ºfprotokollen, deren Echtheit bislang von keiner offiziellen Stelle bestritten wurde. Ein anonymer Chemietechniker sagt, die Werte l√§gen ‚Äûdeutlich √ºber dem, was man f√ºr unbedenklich h√§lt‚Äú. Belege daf√ºr werden nicht vorgelegt.",
    "Die Beh√∂rden sprechen von routinem√§√üigen Qualit√§tskontrollen und sehen keinen Anlass zur Sorge. Doch laut internen Dokumenten, die Insider einsehen konnten, seien schon l√§nger ‚ÄûAnpassungen‚Äú an den Grenzwerten diskutiert worden ‚Äì angeblich, um Berichte √ºber √úberschreitungen zu vermeiden.",
    "Bemerkenswert ist, dass gro√üe Medien kaum dar√ºber berichten. Stattdessen w√ºrden kritische Stimmen diffamiert. In einem viel geteilten Beitrag hei√üt es: ‚ÄûWenn das alles nicht stimmt, warum schweigen sie dann?‚Äú Diese Frage wird als Beweis daf√ºr interpretiert, dass die Vorw√ºrfe Substanz haben.",
    "Fakt ist: Bislang gibt es keine √ºberpr√ºfbaren Quellen, die die Anschuldigungen zweifelsfrei best√§tigen. Dennoch verbreitet sich die Geschichte rasant ‚Äì getrieben von Emotionalit√§t, vagen Autorit√§tsbehauptungen und der Erz√§hlung einer gezielten Vertuschung."
  ].join(` ${PARA} `),
  phraseSpecs: [
    { text:"Laboranalyse, die unserer Redaktion exklusiv zugespielt wurde", explanation:"Scheinexklusivit√§t soll Glaubw√ºrdigkeit erzeugen, Quelle bleibt unklar." },
    { text:"Aus gut informierten Kreisen hei√üt es", explanation:"Vage Berufung auf Autorit√§t ohne Nachpr√ºfbarkeit." },
    { text:"bewusst im Unklaren gelassen", explanation:"Unterstellt Absicht/Vertuschung ohne Beleg." },
    { text:"deren Echtheit bislang von keiner offiziellen Stelle bestritten wurde", explanation:"Kein Dementi als Beweis zu werten ist ein Trugschluss." },
    { text:"Ein anonymer Chemietechniker", explanation:"Anonym + Berufsbezeichnung = Aura von Expertise ohne Verantwortung." },
    { text:"laut internen Dokumenten, die Insider einsehen konnten", explanation:"Unverifizierbare Einsicht ‚Äì klassisches Insider-Framing." },
    { text:"Bemerkenswert ist, dass gro√üe Medien kaum dar√ºber berichten", explanation:"Schweigekartell-Narrativ, um seri√∂se Quellen zu diskreditieren." },
    { text:"Wenn das alles nicht stimmt, warum schweigen sie dann?", explanation:"Beweislast-Umkehr: Schweigen wird als Best√§tigung umgedeutet." }
  ]
};

/* ---------- App-State ---------- */
const levels = [level1, level2];
let current = null;         // aktuelles Level-Objekt
let tokens = [];
let occurrences = [];
let selected = new Set();

/* ---------- Home (Level-Auswahl) ---------- */
function renderHome(){
  const home = document.getElementById("home");
  home.innerHTML = "";
  levels.forEach((lv, idx)=>{
    const card = document.createElement("div");
    card.className = "card";
    card.innerHTML = `
      <span class="tag">Level ${idx+1}</span>
      <h2>${lv.title}</h2>
      <p class="teaser">${lv.teaser}</p>
    `;
    card.addEventListener("click", ()=>startGame(idx));
    home.appendChild(card);
  });

  // Sichtbarkeit
  document.getElementById("home").style.display = "grid";
  document.getElementById("game").style.display = "none";
}

/* ---------- Spiel starten ---------- */
function startGame(index){
  current = levels[index];
  document.getElementById("levelTitle").textContent = `Level ${index+1} ‚Äì ${current.title}`;
  document.getElementById("feedback").innerHTML = "";
  document.getElementById("score").textContent = "0";
  selected.clear();

  // Tokenize & map using ONE source string
  tokens = tokenize(current.source);
  occurrences = [];
  mapPhrases(current.source);

  // Render paragraphs + tokens
  renderPost();

  // Sichtbarkeit
  document.getElementById("home").style.display = "none";
  document.getElementById("game").style.display = "block";
}

/* ---------- Tokenisierung (beh√§lt Whitespaces als Tokens) ---------- */
function tokenize(text){
  const re = /(\s+|[^\s]+)/g;
  const out=[]; let m, i=0;
  while((m=re.exec(text))!==null){
    out.push({ text:m[0], start:m.index, end:m.index+m[0].length, idx:i, el:null, occIds:[] });
    i++;
  }
  return out;
}

/* ---------- Phrasen-Mapping ---------- */
function mapPhrases(text){
  const lower = text.toLowerCase();
  current.phraseSpecs.forEach((p,pIdx)=>{
    const target = p.text.toLowerCase();
    let pos = 0;
    while(true){
      const f = lower.indexOf(target, pos);
      if(f === -1) break;
      const e = f + target.length;
      const ids = tokens.filter(t => !(t.end <= f || t.start >= e)).map(t=>t.idx);
      const id = occurrences.length;
      occurrences.push({ id, phraseIdx:pIdx, tokens:ids });
      ids.forEach(i => tokens[i].occIds.push(id));
      pos = e;
    }
  });
}

/* ---------- Rendering mit Absatz-Marker ---------- */
function renderPost(){
  const post = document.getElementById("post");
  post.innerHTML = "";
  let pEl = document.createElement("p");

  tokens.forEach(t=>{
    if(t.text.includes(PARA)){
      post.appendChild(pEl);
      pEl = document.createElement("p");
      return; // Marker selbst nicht anzeigen
    }
    const span = document.createElement("span");
    span.textContent = t.text;
    span.className = "token";
    t.el = span;
    span.addEventListener("click", ()=>handleClick(t));
    pEl.appendChild(span);
  });
  post.appendChild(pEl);
}

/* ---------- Interaktion ---------- */
function handleClick(t){
  if(t.occIds.length){
    toggleOccurrence(t.occIds[0]);
  } else {
    const sel = t.el.classList.toggle("marked");
    const id = "single-"+t.idx;
    sel ? selected.add(id) : selected.delete(id);
    updateScore();
  }
}
function toggleOccurrence(id){
  const occ = occurrences[id];
  const active = occ.tokens.every(i => tokens[i].el.classList.contains("marked"));
  occ.tokens.forEach(i => tokens[i].el.classList.toggle("marked", !active));
  if(active) selected.delete(id); else selected.add(id);
  updateScore();
}
function updateScore(){
  document.getElementById("score").textContent = selected.size;
}

/* ---------- Feedback ---------- */
function checkAnswers(){
  const fb = document.getElementById("feedback");
  fb.innerHTML = "<h2>Auswertung</h2>";
  const ul = document.createElement("ul");
  let correct = 0;
  occurrences.forEach(o=>{
    const picked = o.tokens.every(i => tokens[i].el.classList.contains("marked"));
    const p = current.phraseSpecs[o.phraseIdx];
    const li = document.createElement("li");
    li.innerHTML = (picked ? "‚úÖ " : "‚ö†Ô∏è ") + `<strong>${p.text}</strong> ‚Äî ${p.explanation}`;
    ul.appendChild(li);
    if(picked) correct++;
  });
  fb.appendChild(ul);
  fb.insertAdjacentHTML("beforeend", `<p><strong>Punkte:</strong> ${correct} / ${occurrences.length}</p>`);
}

/* ---------- Reset & Back ---------- */
function resetAll(){
  selected.clear();
  tokens.forEach(t=>t.el && t.el.classList.remove("marked"));
  document.getElementById("feedback").innerHTML = "";
  updateScore();
}
function goHome(){
  resetAll();
  current = null;
  renderHome();
}

/* ---------- Events & Init ---------- */
document.getElementById("checkBtn").onclick = checkAnswers;
document.getElementById("resetBtn").onclick = resetAll;
document.getElementById("backBtn").onclick  = goHome;

renderHome(); // Startansicht
</script>
</body>
</html>
